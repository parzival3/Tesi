\chapter{LPWAN}
La grande diversità degli scenari applicativi che l'IoT porta con se, rende
difficile creare uno standard alla base del network layer.
Applicazioni quali smart-meter(contatori intelligenti) o centraline meteo  ad
esempio, richiedono uno scambio di dati esiguo rispetto ad applicazioni di
video-sorveglianza o votate al trattamento di dati sensibili.
Le tecnologie wireless tradizionali non sono in grado di soddisfare tutti i vari
use-case dell'IoT. 
Con questo capitolo si vogliono aproffondire le problematiche riguardanti il
network layer, andando a trattare le problematiche presenti e come diverse
tecnologie stanno cercando di superarle.

\section{Alla base delle reti LPWAN}
Fino ad oggi la scelta limitata di tecnologie wireless capaci di avere un ampia
area di operabilità, ha forzato le case produttrici ad utilizzare la rete
celluare per le comunicazioni M2M. Molto spesso questa scelta risulta
svantaggiosa poiché ,data la difficoltà di modulazione e
demodulazione delle complesse forme d'onda, è necessario implementare hardware
sovradimensionato all'interno dei dispositivi. 

È necessario quindi ridisegnare da zero
Essendoci la necessità di sviluppare il network layer partendo da zero è
importante capire quali sono le principali problematiche che le tecnologie
wireless attuali non riescono a superare.

Questa rapida di dispositivi connessi porta con se nuove problematiche. È
impensabile riuscire a gestire un questo elevato numero di devices con le
tecnologie tutt'ora utilizzate. Se il problema dell'indirizzamento è stato
risolto con l'introduzione dell'IPv6, è necessario ridisegnare 
l'architettura in modo tale da garantire il servizio anche in presenza di
milioni di dispositivi connessi contemporaneamente. 
I principali problemi che devono essere ancora risolti sono:
\begin{itemize}
\item \textit{Indirizzabilità}: a causa dell’elevato numero di oggetti che entrano in
gioco in IoT, la capacità di indirizzamento di IPv4 non è più suffi-
ciente. IPv4 usa 32 bit per gli indirizzi, quindi ce ne possono essere
massimo 2 32 diversi. Gli ultimi indirizzi IPv4 sono stati assegnati nel
Febbraio 2010. Il passaggio a IPv6 (nel frattempo si stanno adottando
situazioni temporanee) risolverà il problema, in quanto si passerà da
32 bit a 128 bit per gli indirizzi. IPv6 inoltre porterà miglioramenti
in termini di sicurezza e semplificazioni nella gestione delle reti grazie
a funzionalità di autoconfigurazione.
\item \textit{Scalabilità}: Dato l'elevato numero di devices previsti nei scenari
urbani ed industriali, la network technology alla base della rete dovrà essere 
adattabile, in modo dinamico, al carico di dispositivi connessi.
\item \textit{"Arrive and operate”}: dispositivi mobili eventualmente aggiunti do-
po la formazione iniziale del sistema, non devono aver bisogno di
configurazione, ma devono essere in grado di stabilire connessioni
autonomamente con gli altri oggetti già presenti.
\item \textit{Costo unitario}: Il costo del end device, dovrà essere conveniente
per garantire la più ampia fetta di mercato.
\item \textit{Fonti di energia}: probabilmente una delle maggiore problematiche.
Gli oggetti nella maggior parte dei casi sono mobili, quindi non han-
no sempre la possibilità di essere collegati a una fonte di energia. Le
batterie inoltre sono pesanti e grandi. Servono sistemi per produr-
re energia dall’ambiente circostante, in modo da rendere i dispositivi
autosufficienti (ad esempio sfruttando la luce, il vento), che sfortunatamente,
seppure ci siano progressi, non sono ancora in grado di
risolvere il problema. E’ necessario quindi anche ridurre la quantità
di energia richiesta dagli oggetti.
\item \textit{Interoperabilità}: gli oggetti sono di natura diversa (per esempio pos-
sono avere requisiti di larghezza di banda diversi, o hardware diverso).
Questo implica la necessità di standard, in modo che oggetti di tipo
diverso possano comunicare tra loro
\item \textit{Costo computazionale}: La modulazione, alla base di queste nuove
tipologie di rete, dovrà essere concepita in modo da non richiedere un costo
computazionale elevato .
\item \textit{Raggio d'azione}: La necessità di utilizzare questi devices in ambienti
difficili o rurali, rende necessario poter instaurare una comunicazione con
devices che si trovano a chilometri di distanza.
\item \textit{Sicurezza}: Lo scambio dei dati dovrà avvenire in maniera sicura,
implementando algoritmi di cifratura dei dati o procedure di handshaking.
\item \textit{Tolleranza ai guasti}: Il mal funzionamento  o il guasto di un
nodo della rete,  non dovrà compromettere il funzionamento dell'intera rete a lui connessa. 
\end{itemize}

\section{LPWAN}
Per colmare il gap tra tecnologie esistenti e la
necessita di connettere milioni di devices diversi, sono nate le  LPWAN
\emph{Low power wide area network}.
Le reti LPWAN rappresentano un modello  di comunicazione
innovativo, che integra le tecnologie cellulari tradizionali e quelle a corto
raggio per affrontare diverse esigenze delle applicazioni IoT. Le tecnologie
LPWA offrono un insieme di funzionalità uniche, risultando capaci di
connettere un gran numero di devices con bassa capacità di elaborazione e a basso
consumo energetico, altrimenti impossibile per le tecnologie presenti al giorno
d'oggi.

\begin{figure}[h]
    \centering 
        \includegraphics[width=16cm]{network-com}
    \caption{Comparazione tipologia di reti}
\end{figure}

In questo contesto, i maggiori competitor sono  NB-IoT, EC-GSM-IoT
LTE-M, SigFox e Lora. Le prime tre  sono una evoluzione delle precedenti reti
cellulari 2G,3G e 4G. Operando su bande di frequenza licenziate, e necessario
che ognuna di queste tecnologie sia approvata dalla 3GPP ( 3rd Generation
Partnership Project), la quale si occupa della standardizzazione dei sistemi di
telecomunicazione a livello internazionale.
All'opposto, Sigfox e Lora sono due tecnologie che operano sulle frequenze ISM
(Industrial, Scientific and Medical). Le frequenze ISM sono uno spettro radio
riservato alle applicazioni di radiocomunicazione non commerciali.
esse variano da stato a stato. In particolare entrambe le tecnologie operano
alle nella banda degli 868[MHz] la quale permette una potenza del segnale
inviato massima pari a 14[dbm] ed un duty cycle inferiore al 1\%.
 
\section{NB-IoT}
Narrowband IoT (NB-IoT) o LTE Cat NB1 è uno standard certificato nella release 13 del 3GPP, la
quale riutilizza le infrastrutture già presenti, quali 2G, 3G, 4G per la rapida
realizzazione di una rete LPWA per l'IoT.
Focalizzandosi sulla durata della batteria, i moduli NB-IoT risultano avere un
costo all'unità minore del 75\% rispetto ad un normale modulo LTE.
Basato frequenze licenziate, NB-IoT è in grado di
offrire tre diversi scenari di sviluppo \cite{NB-white_paper}
\begin{itemize}
\item \emph{standalone}, utilizzando qualsiasi spettro disponibile del
operatore.
\item \emph{guard band}, utilizzando lo spettro libero presente tra due bande
radio, per prevenire interferenze.
\item \emph{in band}, utilizzando lo stesso spettro della banda LTE.
\end{itemize}
\begin{figure}[h]
    \centering 
        \includegraphics[width=16cm]{nb-iot}
    \caption{Modalità di funzionamento NB-IoT}
\end{figure}
L'obbiettivo che NB-IoT si prefigge è quello di mettere a disposizione una
tecnologia con una elevata copertura ed un basso data-rate. La possibilità di
riutilizzare strutture già esistenti, ed il basso costo per device , rendo
NB-IoT, una delle tecnologie che sta riscuotendo maggiore successo nel abito IoT.



\section{LTE-M}
Dalla realise 8 del 3GPP, diverse nuove tipologie di rete LTE sono disponibili.
La categoria che offre le migliori performance batteria/data-rate è la categoria
LTE Cat-M1 o LTE-M.
LTE-M a differenza del NB-IoT, rispecchia LTE in pieno, quindi implementa due
moduli di ricezione, è full duplex supportando la Frequency Division Multiplexing
(FDM) e Time Division Multiplexing (TDM). Risultando adatto per applicazioni con
esigenze diverse da quelle del NB-IoT, è in grado di raggiunger i 5Mbps in
uplink e 10[Mbps] in downlink teorici.  Questo tipo di connessione sarà utile
per tutte quelle applicazioni in cui è richiesta una elevata sicurezza del dato
da trasmettere, come ad esempio applicazioni di video-sorveglianza o automotive
.Questa tecnologia ,già disponibile negli Stati Uniti tramite la rete Verizon, è
in fase di roll out per molti operatori europei.

\section{EC-GSM-IoT}
EC-GSM-IoT si basa su funzionalità aggiuntive a partire da EGPRS che consentono
ad una rete GSM/EDGE di essere predisposta per fornire servizi IoT. Lo standard
è stato pensato in particolare per quei Paesi, come quelli in via di sviluppo,
dove una rete LTE non è ancora disponibile. L’occupazione spettrale di ogni
canale corrisponde a  200 kHz.  Tuttavia, al fine di dispiegare EC-GSM-IoT, si
richiede una banda utile di 2.4 MHz per permettere il frequency hopping , che,
con l’aggiunta di 2 canali di guardia di 200 kHz ciascuno agli estremi della
banda, porta l’occupazione di banda complessiva a 2.8 MHz.  La
potenza di trasmissione del Il data rate di picco raggiungibile sia in DL sia in
UL è di 491 kbps, mentre il valore mediato nominale è di 98 kbps sia in DL sia
in UL. Al fine di soddisfare i requisiti di capacità (più di 50.000 terminali in
ogni singolo settore di una cella trisettoriale). 

La figura \ref{tab:IoT_cell_comp} riassume in breve le varie caratteristiche
delle reti cellulari facenti parte della categoria LPWA
\begin{table}[h]
    \centering 
                \includegraphics[width=16cm]{tim_iot}
    \caption{Comparazione reti cellulari per l'IoT}
    \label{tab:IoT_cell_comp} 
\end{table}



\section{Sigfox}
SigFox, azienda francese, sta sviluppando in partnership con altri operatori di
rete una soluzione LPWAN basata sulla sua tecnologia. Sigfox punta alla
costruzione di una rete mondiale proprietaria basata su frequenze ISM.
Correntemente SigFox è presente in Francia, Belgio, Olanda e Portogallo come
illustrato nella figura \ref{fig:Sig_covereg}.
\begin{figure}[h]
    \centering 
                \includegraphics[width=11cm]{SigFox_covereg}
    \caption{Mappa copertura SigFox}
    \label{fig:Sig_covereg} 
\end{figure}

Gli end-devices comunicano con le varie base stations usando una modulazione (BPSK)
\emph{Binary Phase Shift Keying} con una banda di soli 100[Hz]. 
Per via delle regolazioni vigenti nello spettro ISM, è per garantire una durata
della batteria pari ad una decina di anni, il numero massimo di messaggi
inviabili in un giorno è 140, con lunghezza del payload pari a 12[byte] e un
throughput pari a 100[bps]. SigFox si colloca come rete LPWAN con il minore
throughput, limitando il numero di use-case possibili. Inizialmente SigFox
supportava solo comunicazioni unidirezionali, successivamente, ha introdotto la
possibilità di avere una comunicazione bidirezionale, limitando il numero di
byte trasmissibili da gateway a devices a 4-8 bytes per giorno.

\section{LoRaWAN}
\emph{LoraWAN} è una tecnologia di modulazione wireless semi-proprietaria 
sviluppata da Semtech. Essa è composta da un layer fisico ,proprietario, che
prende il nome di \emph{Lora}\cite{LoRaCss101} , e una parte libera chiamata 
LoRaWAN\cite{LoRaWAN101} nella quale viene definito un protocollo di comunicazione, 
il quale usa LoRa come layer fisico. 
Basandosi su una tecnica di comunicazione a \emph{spread spectrum}, LoRa è in
grado di instaurare una comunicazione bidirezionale tra device e gateway.
I punti chiave dei questa tecnologia, sono il grande raggio di copertura , il 
basso consumo energetico e la capacità di adattare in maniera dinamica il
data rate, il quale può variare dai 0.3 ai 50[Kbps] a seconda dell'utilizzo. 
Come per SigFox, la tecnologia sviluppata da Semtech, si basa sulle bande ISM,
inoltre Essendo il protocollo LoRaWAN open source, si ha la possibilità di
creare delle reti pubbliche o private senza disporre di alcuna licenza, 
riducendo così il time to market di questa tecnologia.  
Progetti come \href{https://www.thethingsnetwork.org/}{The Things Network}
mirano a creare una rete LoRa ,pubblica è privata,  a livello globale.
\section{Osservazioni}
In questo mercato frammentato, non è semplice capire quale tecnologia sia adatta
a ricoprire una data applicazione. Essendo questi standard molto giovani, è
difficile comprendere le reali potenzialità di ognuna di queste soluzioni.
Quello che è possibile prevedere, sarà un incremento esponenziale di device che
stanno alla base della piramide in figura \ref{fig:pyramid}, devices i quali
potranno essere utilizzati in innumerevoli settori, non ancora esplorati dalle
tecnologie attuali, come per esempio i contatori della dell'acqua, applicazioni
per l'agricoltura di precisione ecc. 

\begin{figure}[h]
    \centering 
                \includegraphics[width=11cm]{pyramid}
    \caption{Capacità delle reti LPWA}
    \label{fig:pyramid} 
\end{figure}

\pagebreak
Per le aziende, che si apprestano ad investire sul mondo dell'IoT, la scelta
della corretta tecnologia su cui andare a sviluppare i loro servizi non risulta
semplice, in quanto, fattori quali sicurezza, aggiornamenti software,
affidabilità devono essere ancora testate a pieno. Con la figura
\ref{fig:feature_comp} si vuole riassumere in breve i punti chiave delle
tecnologie appena trattate.

\begin{figure}[h]
    \centering 
                \includegraphics[width=11cm]{Comparsion_no_line}
    \caption{Comparazione feature reti LPWAN}
    \label{fig:feature_comp} 
\end{figure}

Nel prossimo capitolo verrà analizzata in dettaglio la soluzione che Semtech
propone, approfondendo il layer fisico \emph{Lora} e la struttura del protocollo
LoRaWAN.
